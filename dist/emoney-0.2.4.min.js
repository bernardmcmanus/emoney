/*! emoney - 0.2.4 - Bernard McManus - master - g3b5bc7 - 2015-03-22 */
(function(){"use strict";function a(){var b=A.now(),c=a.last,d=.001;return c=(b===B.floor(c)?c:b)+d,a.last=c,c}function b(a){return a.length}function c(a,b){return a.indexOf(b)}function d(a){return y.isArray(a)}function e(a){return d(a)?a:a!==x?[a]:[]}function f(a,b){return e(a).forEach(b)}function g(a){return z.create(a)}function h(a,b,c){c.configurable=o(c.configurable,"boolean")?c.configurable:!0,z.defineProperty(a,b,c)}function i(a,b){delete a[b]}function j(a){return z.keys(a)}function k(a){return y[C].shift.call(a)}function l(a){return y[C].pop.call(a)}function m(a,b,c){return y[C].slice.call(a,b||0,c)}function n(a){return a[b(a)-1]}function o(a,b){return typeof b==F?typeof a==b:a instanceof b}function p(a){return o(a,D)?a:function(){}}function q(a){return(a||{})[K]?a[K]:a}function r(a,b){return a===b?null:a}function s(a){var b=this;return o(b,s)?void b.__init(b,a||{}):new s(a)}function t(b,c){var d=this;d.target=b,d.type=c,d[L]=!1,d[M]=!1,d.timeStamp=a()}function u(b,c,d){var f=this;f.func=b,f.context=c,f.uts=a(),f.bindArgs=e(d),f._reset(f)}function v(a,b){var d=a.map(function(a){return a.func});return c(d,b)}function w(){var a=g(R);return a.__init=function(a,b){for(var c in b)a[c]=b[c];S(a)},a.$watch=function(a){var b=this;return f(a,function(a){a.$when(G,b)}),b},a.$ignore=function(a){var b=this;return f(a,function(a){a.$dispel(G,!0,b)}),b},a.$$enq=function(a){var b=this;b.__stack.push(a)},a.$$flush=function(a){var c,d=this,e=d.__stack;if(!d.__inprog||a){for(d.__inprog=!0;b(e);)try{c=k(e),a||c()}catch(f){throw d.$$flush(!0),f}d.__inprog=!1}},a}var x,y=Array,z=Object,A=Date,B=Math,C=(Error,"prototype"),D="function",E="object",F="string",G="*",H="$when",I="$emit",J="$dispel",K="handleE$",L="cancelBubble",M="defaultPrevented",N=s,O=t;t[C]={preventDefault:function(){this[M]=!0},stopPropagation:function(){this[L]=!0}};var P=u;u[C]={_reset:function(a){a.before=p(),a.after=p()},invoke:function(a,b){var c=this;if(!a[L]){var d=c.func,f=m(c.bindArgs).concat(e(b));f.unshift(a),c.before(a,d),d.apply(c.context,f),a[M]||c.after(a,d),c._reset(c)}}};var Q=function(a){return a&&o(a,E)&&K in a},R={$once:function(){var a=this,b=a.__parse(H,arguments);return a._$when(arguments,function(c){c.before=function(c,d){a.$dispel(b[0],!0,d)}}),a.$$flush(),a},$when:function(){var a=this;return a._$when(arguments),a.$$flush(),a},$emit:function(){var a=this,b=a.__parse(I,arguments);return a.$$enq(function(){f(b[0],function(c){c!=G&&a.__invoke(c,b[1],b[2])})}),a.$$flush(),a},$dispel:function(){var a=this,b=a.__parse(J,arguments),c=q(b[2]);return a.$$enq(function(){f(b[0],function(d){a.__remove(d,c,!!b[1])})}),a.$$flush(),a},_$when:function(a,b){b=p(b);var c=this,d=c.__parse(H,a),e=q(d[2]),g=r(d[2],e);c.$$enq(function(){f(d[0],function(a){var f=c.__add(a,e,g,d[1]);b(f)})})},__parse:function(a,d){{var g=this,h=[];g.__events}return d=m(d),f([0,1,2],function(f){f?2>f?(h[2]=o(n(d),D)||Q(n(d))?l(d):null,h[2]=a!=J?h[2]||g:h[2]):h[1]=d[0]:(h[0]=k(d)||e(a!=H?g.__events:G),a==I&&(h[0]=1!=b(h[0])||c(h[0],G)?h[0]:g.__events))}),h},__get:function(a,b){var c=this,d=c.handlers,f=a?e(d[a]):d;return a&&b&&a!=G&&(f=c.__get(G).concat(f).sort(function(a,b){return a.uts-b.uts})),f},__invoke:function(a,b,c){var d=this,e=d.__get(a,!0),g=new O(d,a);f(e,function(a){a.invoke(g,b)}),g[M]||p(c)(g)},__add:function(a,b,c,d){var e=this,f=new P(b,c,d),g=e.__get(a);return g.push(f),e.handlers[a]=g,f},__remove:function(a,c,d){for(var e,f=this,g=f.__get(),h=f.__get(a),j=0;j<b(h);)e=c?v(h,c):j,e>=0&&(d||a!=G)&&(h.splice(e,1),j--),j++;b(h)?g[a]=h:i(g,a)}},S=function(a){h(a,"__stack",{value:[]}),h(a,"__inprog",{value:!1,writable:!0}),h(a,"__events",{get:function(){return j(a.handlers)}}),h(a,"handlers",{value:{}}),h(a,K,{value:p(a[K]).bind(a)})},T=w(),U=function(a){var b=g(T);for(var c in a)b[c]=a[c];return b};N[C]=T,N.is=Q,N.create=U,N.construct=S;var V=N;"function"==typeof define&&define.amd?define([],function(){return V}):"object"==typeof exports?module.exports=V:this.E$=V}).call(this);